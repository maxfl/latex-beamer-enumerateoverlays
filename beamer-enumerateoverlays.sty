\ProvidesPackage{beamer-enumerateoverlays}
\RequirePackage{beamerbaserequires}
\RequirePackage{relsize}
\RequirePackage{etoolbox}

%
% Enumerate subframes
%
\def\subframe@formatter{\relsize{-0.5}\ensuremath{_{\insertoverlaynumber}}}%
\newcommand\enumerateoverlays{%
  \addtobeamertemplate{footline}{%
    \ifltxcounter{subframe@\theframenumber}{}{%
      \newcounter{subframe@\theframenumber}%
      \setcounter{subframe@\theframenumber}{0}%
    }
    \ifnumcomp{\csuse{thesubframe@\theframenumber}}{=}{1}{}{
      \write\@auxout{%
        \csgdef{frame@needs@overlay@number@\theframenumber}{}%
      }%
      \csdef{frame@needs@overlay@number@\theframenumber}{}%
    }%
    \stepcounter{subframe@\theframenumber}%
    \begingroup%
    \ifcsdef{frame@needs@overlay@number@\theframenumber}{%
      \appto{\insertframenumber}{\subframe@formatter{}}%
    }{}%
  }{\endgroup}%
  % treat broken frames as overlays (freeze frame counter)
  \addtobeamertemplate{frametitle continuation}{}{%
    \ifnumcomp{\beamer@autobreakcount}{>}{1}{\addtocounter{framenumber}{-1}}{}%
  }%
}

\endinput
